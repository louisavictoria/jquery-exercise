<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Member Dashboard - Palette of Dreams</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;600;700&family=Libre+Baskerville:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="dashboard.css"> 
</head>
<body>

    <nav class="navbar navbar-expand-lg custom-navbar fixed-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="index.html">Palette of Dreams</a>
            <div class="d-flex align-items-center">
                <span id="welcomeMsgNav" class="text-white me-3 d-none d-sm-block small"></span>
                <button id="logoutBtn" class="btn btn-sm btn-light">Logout</button>
            </div>
        </div>
    </nav>

    <div class="container dashboard-container">
        <div class="dashboard-card">
            
            <header class="text-center mb-5">
                <h1 class="display-5 fw-bold mb-2 text-primary">Your Member Dashboard</h1> 
                <p class="lead text-secondary">Manage your account, view bookings, and explore new exhibits.</p>
            </header>
            
            <div class="row g-5">
                
                <div class="col-lg-6">
                    
                    <div class="mb-4">
                        <h3 class="section-header mb-3">Your Profile</h3>
                        <div class="card p-4 border-0 shadow-sm d-flex flex-column hover-card"> 
                            <div class="row align-items-center">
                                <div class="col-md-3 text-center mb-3 mb-md-0">
                                    <img src="profile-icon.jpg" alt="User Profile Picture" class="profile-img shadow-sm"> 
                                </div>
                                
                                <div class="col-md-9">
                                    <h5 class="mt-2 mb-2 fw-bold text-primary" id="profileNameDashboard"></h5> 
                                    <ul class="list-group list-group-flush"> 
                                        
                                        <li class="list-group-item d-flex justify-content-between align-items-center bg-transparent pt-0 pb-1">
                                            <b class="text-muted">Username:&nbsp;</b>
                                            <span class="fw-bold" id="profileEmailDashboard"></span>
                                        </li>
                                        
                                        <li class="list-group-item d-flex justify-content-between align-items-center bg-transparent py-1">
                                            <b class="text-muted">Membership:</b>
                                            <span class="badge bg-primary text-white">Full Member</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center bg-transparent pt-1 pb-0">
                                            <b class="text-muted">Join Date:</b>
                                            <span class="text-muted small">Since Today</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-5"> 
                        <h3 class="section-header mb-3">Upcoming Visit</h3>
                        <div id="upcomingBookings" class="alert border-0 shadow-sm p-4 d-flex flex-column justify-content-center align-items-center hover-card">
                            <p class="mb-0 text-dark text-center lead">You have no active bookings. Time to plan your next visit!</p>
                        </div>
                    </div>
                    
                    <hr class="my-5"> 
                    
                    <h3 class="section-header mb-4">Current & Upcoming Exhibits</h3>
                    <div class="row row-cols-1 g-3">
                        
                        <div class="col">
                            <div class="card exhibit-card p-4 shadow-sm border-start border-4 border-info hover-card">
                                <h5 class="card-title fw-bold text-info">Claude Monet: Water and Light</h5>
                                <p class="card-text small mb-1">Explore his iconic series from the Giverny gardens.</p>
                                <p class="card-text small mb-0">Availability: <b>Mon - Sat</b></p>
                            </div>
                        </div>

                        <div class="col">
                            <div class="card exhibit-card p-4 shadow-sm border-start border-4 border-warning hover-card">
                                <h5 class="card-title fw-bold text-warning">Vincent van Gogh: Passion and Color</h5>
                                <p class="card-text small mb-1">Featuring expressive works from his Arles and Saint-RÃ©my period.</p>
                                <p class="card-text small mb-0">Availability: <b>Tue - Sun</b></p>
                            </div>
                        </div>
                        
                    </div>
                </div>

                <div class="col-lg-6">
    <div class="p-4 rounded-3 shadow-lg h-100 bg-light d-flex flex-column"> 
        <h3 class="section-header mb-4 text-center">Book a New Visit</h3>
        
        <form id="bookingForm" class="p-2 flex-grow-1 d-flex flex-column">
            <div class="booking-image-container flex-grow-1 mb-4 mt-2">
                <img src="starry-night.jpg" alt="Artwork preview for booking" class="img-fluid rounded-3 w-100 h-100 object-fit-cover shadow-sm">
            </div>
            <div class="mb-3">
                <label for="exhibit" class="form-label fw-bold">Select Exhibit</label>
                <select class="form-select" id="exhibit" name="exhibit">
                    <option value="">Choose an Exhibit...</option>
                    <option value="monet">Claude Monet: Water and Light</option>
                    <option value="vangogh">Vincent van Gogh: Passion and Color</option>
                    <option value="renoir">Pierre-Auguste Renoir: Joy of Life</option>
                </select>
            </div>
            
            <div class="mb-3">
                <label for="visitDate" class="form-label fw-bold">Visit Date</label>
                <input type="date" class="form-control" id="visitDate" name="visitDate">
            </div>
            
            <div class="mb-3">
                <label for="visitTime" class="form-label fw-bold">Time Slot</label>
                <select class="form-select" id="visitTime" name="visitTime">
                    <option value="">Choose a Time Slot...</option>
                    <option value="1000">10:00 AM</option>
                    <option value="1300">1:00 PM</option>
                    <option value="1530">3:30 PM</option>
                </select>
            </div>

            <button type="submit" class="btn btn-primary mt-auto w-100 fw-bold">Confirm Booking</button>
            </form>
        </div>
    </div>
                   
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="welcomeModal" tabindex="-1" aria-labelledby="welcomeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title fw-bold" id="welcomeModalLabel">Login Successful!</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center py-4">
                    <h2 class="fw-bold mb-3 text-primary">Welcome,</h2>
                    <h4 id="welcomeMessage"></h4> 
                    <p class="lead mt-3">Ready to explore the Modern Masters Collection?</p>
                </div>
                <div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Go to Dashboard</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        const user = sessionStorage.getItem("loggedInUser");
        const logoutButton = document.getElementById("logoutBtn");

        if (!user) {

            window.location.href = "login.html";
        } else {

            document.getElementById("welcomeMsgNav").innerText = `Hello, ${user}!`;
            document.getElementById("profileNameDashboard").innerText = user;
            document.getElementById("profileEmailDashboard").innerText = user;

            if (sessionStorage.getItem("userJustLoggedIn") === "true") {
                document.getElementById("welcomeMessage").innerText = `${user}!`;
                const welcomeModal = new bootstrap.Modal(document.getElementById("welcomeModal"));
                welcomeModal.show();
                sessionStorage.removeItem("userJustLoggedIn");
            }
        }

        $(document).ready(function () {
            $("#bookingForm").validate({
                rules: {
                    exhibit: { required: true },

                    visitDate: { required: true, date: true, min: new Date().toISOString().split('T')[0] }, 
                    visitTime: { required: true }
                },
                messages: {
                    exhibit: "Please select an exhibit you wish to visit.",
                    visitDate: "Please select a valid future date for your visit.",
                    visitTime: "Please select a time slot for your visit."
                },
                submitHandler: function (form) {
                    const exhibitName = $("#exhibit option:selected").text();
                    const date = $("#visitDate").val();
                    const time = $("#visitTime option:selected").text();

                    alert(`Booking Successful! You have reserved a spot for the ${time} on ${date} for the ${exhibitName} exhibit.`);
                    
                    form.reset();
                    return false;
                }
            });
        });

        logoutButton.addEventListener('click', () => {
            sessionStorage.removeItem("loggedInUser");
            window.location.href = "index.html"; 
        });
    </script>

</body>
</html>